---
title: "프론트엔드 Keycloak 도입기: JWT에서 SSO로의 여정"
date: 2025-07-13
draft: false
seo:
  title: "MSA 아키텍처를 위한 Keycloak SSO 및 권한 관리 구현 경험담 - 1"
  description: "MSA 아키텍처를 위한 Keycloak SSO로 전환 과정에서 얻은 교훈을 공유합니다"
  tag: "기술 경험담"
  type: "technology"
  keywords: "Keycloak SSO JWT 인증 React Next.js 프론트엔드"
---

프로젝트 고도화의 일환으로 기존 JWT 기반 인증 시스템을 Keycloak SSO로 전환하는 과정을 진행하고 있습니다. 아직 도입 초기 단계지만, 그 과정을 기록으로 남겨 공유하고자 합니다.

기존 시스템은 단일 백엔드 서버와 1:1로 통신하며 서버가 발급한 토큰을 관리하는 단순한 구조였습니다. 하지만 MSA 아키텍처로 전환을 결정하면서, Keycloak SSO 도입과 함께 기존 메뉴와 권한 관리 방식을 전면적으로 재검토해야 했습니다.

입사 초기, 프로젝트의 메뉴 데이터를 DB에서 동적으로 관리하도록 개선한 경험이 있습니다. 그러나 프로젝트 규모가 커지고 관리 페이지가 늘어나면서, 권한 관리 체계를 더 세분화해야 한다는 점에 백엔드 개발자와 공감대를 형성했습니다. 기존 방식은 페이지 단위의 단순한 그룹별 권한 부여 모델이라, 버튼 하나의 차이로 동일한 페이지를 복제해서 관리해야 하는 비효율적인 한계가 있었습니다.

새롭게 설계한 방식은 다음과 같습니다. 사용자가 Keycloak을 통해 로그인하면, 프론트엔드는 발급된 토큰을 사용해 권한 서버에 메뉴와 세부 권한 목록을 요청합니다. 응답받은 데이터로 React Context를 생성하고, 페이지를 렌더링할 때마다 사용자는 자신이 보유한 권한에 따라 메뉴와 컴포넌트를 동적으로 보게 됩니다. 이로써 **속성 기반 접근 제어(Attribute-Based Access Control, ABAC)**에 가까운 유연한 권한 관리가 가능해졌습니다.

또한, 토큰의 만료와 재발급을 모두 Keycloak이 중앙에서 처리하므로 프론트엔드의 토큰 관리 로직이 대폭 간소화됩니다. 이는 향후 다른 백엔드 서비스나 신규 프론트엔드 프로젝트를 추가할 때 SSO의 이점을 극대화할 수 있는 확장성 높은 기반이 됩니다.

### 현재의 고민과 해결 방안

물론, 이 과정에서 새로운 고민이 생겼습니다.

**1. 동적 메뉴 데이터의 유효성 검증**
첫 번째 고민은 '권한 서버에서 받은 동적 메뉴 데이터의 유효성을 어떻게 신뢰할 것인가'입니다. 현재는 하드코딩된 기본 메뉴(대시보드 등)와 동적 메뉴를 합쳐서 사용하고 있지만, 이 방식이 최선인지에 대한 확신은 아직 없습니다.

이에 대한 해결책으로, 프론트엔드 단에서 **스키마 기반 유효성 검사**를 도입하는 것을 고려하고 있습니다. `Zod`나 `Yup` 같은 라이브러리를 활용하면, API 응답이 우리가 정의한 스키마를 따르는지 런타임에 검증하여 데이터 불일치로 인한 렌더링 오류를 사전에 차단할 수 있습니다.

**2. 잦은 메뉴 변경과 디렉터리 구조의 동기화 문제**
두 번째 고민은 '프로젝트가 발전하며 메뉴 구조가 자주 변경될 때마다 Next.js의 디렉터리 구조를 수정하는 비용을 어떻게 줄일 것인가'입니다.

이를 해결하기 위해, Next.js의 **동적 라우팅(Dynamic Routing)** 기능을 적극 활용하는 방안을 검토 중입니다. 예를 들어, `pages/app/[[...slug]].js`와 같은 **Catch-all Route**를 하나만 구현하면, 대부분의 애플리케이션 URL을 단일 파일에서 처리할 수 있습니다. 이 페이지는 URL `slug`를 동적으로 해석해 권한 데이터와 매핑하고, 그에 맞는 레이아웃과 컴포넌트를 렌더링합니다. 이 접근법은 메뉴 구조를 파일 시스템으로부터 분리하여, 백엔드에서 메뉴가 변경되어도 프론트엔드 코드 수정은 최소화되는 유연한 구조를 만들어줍니다.
